asyncapi: '2.0.0'
info:
  title: International DATIS Push API
  version: '1.0.0'
  description: |
    DATIS Push API Sample Specification.
  license:
    name: Apache 2.0
    url: https://www.apache.org/licenses/LICENSE-2.0

servers:
  prod:
    url: discovery.caero-non-prod.useast.streams.forge.honeywell.com:443
    protocol: kafka-secure
    description: Honeywell Kafka Cluster

defaultContentType: application/json

channels:
  tracking-ssot-dev.common.flightsummary.connect.sink:
    description: International DATIS Topic.
    subscribe:
      #operationId: datis
      traits:
        - $ref: '#/components/operationTraits/kafka'
      message:
       oneOf: [$ref: "#/components/messages/datisCommonMsg",$ref: "#/components/messages/datisArrMsg",$ref: "#/components/messages/datisDepMsg"]

components:
  messages:
    datisCommonMsg:
      name: Common DATIS
      title: DATIS Message
      summary: Aircraft Info.
      contentType: application/json
      payload:
        $ref: "#/components/schemas/datisCommonMsgPayload"
    datisArrMsg:
      name: Arrival DATIS
      title: DATIS Message
      summary: Aircraft Info.
      contentType: application/json
      payload:
        $ref: "#/components/schemas/datisArrMsgPayload"
    datisDepMsg:
      name: Departure DATIS
      title: DATIS Message
      summary: Aircraft Info.
      contentType: application/json
      payload:
        $ref: "#/components/schemas/datisDepMsgPayload"
    

  schemas:
    datisCommonMsgPayload:
      type: object
      properties:
        airportIcao:
            type: string
            example: "KHOU"
        error:
          type: string
          example: null
        isDatisEnabled:
          type: boolean
        common:
          type: object
          properties:
            summary:
              type: string
              example: "HOU ARR/DEP INFO G 0353Z. 32016G22KT 10SM FEW060 13/02 A2995 (TWO NINER NINER FIVE). LOC RWY 22 APPROACH IN USE. PRIMARY DEPARTURE RWY 22. GROUND CONTROL COMBINED WITH TOW ER ON 118.7. NOTAMS... RUNWAY 13R, 31L, 13L, 31R, 17, 35 CLOSED. TAXIWAY D, E, F, K 2, M 3, TWY C BTN TWY P AND TWY M CLSD. TWY G BTN TWY F AND RWY 13R CLSD. TWY Y BEHIND GATES 45 THROUGH 49 CLOSED. ILS RWY 13R OTS, ILS RWY 31L OTS, RWY 13L PAPI OTS. BIRD ACTIVITY VICINITY HOU APT. HAZD WX INFO FOR HOUSTON AREA AVBL FM FSS. ALL ACFT TAXI WITH TRANSPONDER ON. ...ADVS YOU HAVE INFO G.\r\n"
            lastUpdated:
              type: string
              format: date-time
              example: "2022-03-23 03:54:41"
          required:
            - summary
            - lastUpdated
        arrival:
          type: 'null'
        departure:
          type: 'null'
      required:
      - airportIcao
      - error
      - isDatisEnabled
      - common
    datisArrMsgPayload:
      type: object
      properties:
        airportIcao:
            type: string
            example: "KHOU"
        error:
          type: string
          example: null
        isDatisEnabled:
          type: boolean
        arrival:
          type: object
          properties:
            summary:
              type: string
              example: "HOU ARR/DEP INFO G 0353Z. 32016G22KT 10SM FEW060 13/02 A2995 (TWO NINER NINER FIVE). LOC RWY 22 APPROACH IN USE. PRIMARY DEPARTURE RWY 22. GROUND CONTROL COMBINED WITH TOW ER ON 118.7. NOTAMS... RUNWAY 13R, 31L, 13L, 31R, 17, 35 CLOSED. TAXIWAY D, E, F, K 2, M 3, TWY C BTN TWY P AND TWY M CLSD. TWY G BTN TWY F AND RWY 13R CLSD. TWY Y BEHIND GATES 45 THROUGH 49 CLOSED. ILS RWY 13R OTS, ILS RWY 31L OTS, RWY 13L PAPI OTS. BIRD ACTIVITY VICINITY HOU APT. HAZD WX INFO FOR HOUSTON AREA AVBL FM FSS. ALL ACFT TAXI WITH TRANSPONDER ON. ...ADVS YOU HAVE INFO G.\r\n"
            lastUpdated:
              type: string
              format: date-time
              example: "2022-03-23 03:54:41"
          required:
            - summary
            - lastUpdated
        common:
          type: 'null'
        departure:
          type: 'null'
      required:
      - airportIcao
      - error
      - isDatisEnabled
      - arrival
    datisDepMsgPayload:
      type: object
      properties:
        airportIcao:
            type: string
            example: "KHOU"
        error:
          type: string
          example: null
        isDatisEnabled:
          type: boolean
        departure:
          type: object
          properties:
            summary:
              type: string
              example: "HOU ARR/DEP INFO G 0353Z. 32016G22KT 10SM FEW060 13/02 A2995 (TWO NINER NINER FIVE). LOC RWY 22 APPROACH IN USE. PRIMARY DEPARTURE RWY 22. GROUND CONTROL COMBINED WITH TOW ER ON 118.7. NOTAMS... RUNWAY 13R, 31L, 13L, 31R, 17, 35 CLOSED. TAXIWAY D, E, F, K 2, M 3, TWY C BTN TWY P AND TWY M CLSD. TWY G BTN TWY F AND RWY 13R CLSD. TWY Y BEHIND GATES 45 THROUGH 49 CLOSED. ILS RWY 13R OTS, ILS RWY 31L OTS, RWY 13L PAPI OTS. BIRD ACTIVITY VICINITY HOU APT. HAZD WX INFO FOR HOUSTON AREA AVBL FM FSS. ALL ACFT TAXI WITH TRANSPONDER ON. ...ADVS YOU HAVE INFO G.\r\n"
            lastUpdated:
              type: string
              format: date-time
              example: "2022-03-23 03:54:41"
          required:
            - summary
            - lastUpdated
        common:
          type: 'null'
        arrival:
          type: 'null'
      required:
      - airportIcao
      - error
      - isDatisEnabled
      - arrival
      

  operationTraits:
    kafka:
      bindings:
        kafka:
          groupId: tracking-ssot-dev.common.flightsummary.stream.v1
